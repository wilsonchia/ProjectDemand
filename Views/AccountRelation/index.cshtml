@using MvcDemand.Models
@model AccountRelationModels
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .modal {
        text-align: center;
        position: fixed;
        z-index: 1;
        top: 1%;
        left: 0;
        width: 100%;
        height: 100%;
        font-size: 100%;
        background-color: rgba(0,0,0,0.6) !important;
    }

    .modal_body {
        text-align: center;
        position: absolute;
        background-color: #F6F6F6;
        /*background-color: white;*/
        /*width:90%;*/
        /*width: 870px;*/
        top: 1%;
        left: 0;
        right: 0;
        margin-left: auto;
        margin-right: auto;
        border-style: solid;
        border-color: #2E6E9E;
    }

    .modalU {
        text-align: center;
        position: fixed;
        z-index: 1;
        top: 5%;
        left: 0;
        width: 100%;
        height: 100%;
        font-size: 100%;
        background-color: rgba(0,0,0,0.6) !important;
    }

    .modalU_body {
        text-align: center;
        position: absolute;
        background-color: #F6F6F6;
        /*background-color: white;*/
        /*width:90%;*/
        /*width: 870px;*/
        top: 10%;
        left: 0;
        right: 0;
        margin-left: auto;
        margin-right: auto;
        border-style: solid;
        border-color: #2E6E9E;
    }
</style>
<script type="text/javascript">

    var baseURL = '@Html.Raw(Url.Content("~"))';
    if (baseURL == '/') { baseURL = ""; }

    $(function ($) {
        $('#dropExecute').change(funcSelectChange);
    });

    funcSelectChange = function () {
        var selValue = $('#dropExecute :selected').val();
        $('#showDataCreate').hide(); $('#showDataUpdate').hide(); $('#showUpload').hide();
        switch (selValue) {
            case "":
                $('#showDataUpdate').fadeOut("slow");
                break;
            case "N":
                $('#showDataCreate').fadeIn("slow");
                $("#textAccDateS").datepicker({ dateFormat: 'yy/mm/dd' });
                break;
            case "U":
                $('#showUpload').fadeIn("slow");
                break;
            case "O":
                $('#showDataUpdate').fadeOut("slow");
                FormExcelOut();
                break;
        }
        return false;
    }

</script>
    @using (Html.BeginForm("Index", "AccountRelation", FormMethod.Post, new { id = "form1" }))
{
    <div id="showList">
            <table style="width:100%" border="0" cellpadding="0" cellspacing="0">
                <tr style="height:40px; font-size:20px; font-weight:bold"><td style="width:100%; text-align:center" colspan="2">使用帳號關聯資料檔<hr /></td></tr>
                <tr style="height:35px;">
                    <td style="width:700px; text-align:left">
        關鍵字 : @Html.TextBox("searchValue", (string)ViewBag.searchValue, new { Style = "width:600px; height:35px" })
                    <input type="submit" id="btnsubmit" value="查詢" style="width:100px; height:30px;font-weight:bold;font-size:18px" />
                </td>
                <td style="width:200px; text-align:right">
                    <select id="dropExecute" name="dropExecute" style="width:200px; height:30px;font-size:16px;font-weight:bold">
                        <option value="">請選擇</option>
                        <option value="N">新增帳號關聯</option>
                        <option value="U">匯入關聯資料</option>
                        <option value="O">匯出關聯資料</option>
                    </select>
                </td>
            </tr>
            <tr id="showUpload" style="vertical-align:middle;display:none">
                <td style="width:700px; text-align:left">
                    <input type="file" id="fileUpload" name="fileUpload" style="width:100%; height:30px;" />
                </td>
                <td style="width:200px; text-align:right">
                    <input type="button" id="btnUpload" value="上傳" style="width:100px; height:30px; font-size:16px; font-weight:bold" onclick="FormExcelUpload();" />
                </td>
            </tr>
            <tr><td style="width:100%" colspan="4"><hr /></td></tr>
            <tr><td style="width:100%" colspan="4">@{Html.RenderPartial("list", Model);}</td></tr>
        </table>
    </div>
        
    <div id="showDataCreate" class="modal" style="display:none;text-align:center">
        @Html.Hidden("hideAccountData", Model.aryAccountDetail)
        <table class="modal_body" style="width:1000px;" border="0" cellpadding="0" cellspacing="0">
            <tr style="height:40px; font-size:20px; font-weight:bold"><td style="width:100%; text-align:center" colspan="8">新增帳號關聯資料</td></tr>
            <tr style="height:30px; font-weight:bold; font-size:18px">
                <td style="width:250px; text-align:left" colspan="2">帳號清單</td>
                <td style="width:250px; text-align:left" colspan="2"></td>
                <td style="width:250px; text-align:left" colspan="2">單位清單</td>
                <td style="width:250px; text-align:left" colspan="2"></td>
            </tr>
            <tr><td colspan="8"><hr /></td></tr>
            <tr style="height:40px; font-size:18px; font-weight:bold; color:white; background-color:#5F9EA0">
                <td style="width:250px; text-align:center">一般帳號</td>
                <td style="width:250px; text-align:center">上級主管</td>
                <td style="width:250px; text-align:center">二級主管</td>
                <td style="width:250px; text-align:center">負責窗口</td>
                <td style="width:250px; text-align:center">代理人</td>
                <td style="width:250px; text-align:center">專案經理</td>
                <td style="width:250px; text-align:center">系統分析師</td>
                <td style="width:250px; text-align:center">開發工程師</td>
            </tr>
            <tr><td colspan="8"><hr /></td></tr>
            <tr style="height:35px; font-size:12px;">
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationA.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationA[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationA[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationB.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationB[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationB[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationC.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationC[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationC[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationD.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationD[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationD[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>  
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationE.Count; i++)
                      {

                        @:(
                        @Model.listAccountRelationE[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationE[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationF.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationF[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationF[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationG.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationG[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationG[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>
                <td style="width:125px; text-align:left">
                    @{  for (int i = 0; i < Model.listAccountRelationH.Count; i++)
                      {
                        @:(
                        @Model.listAccountRelationH[i].oAccNo.ToString();
                        @:)<br />
                        @Model.listAccountRelationH[i].oAccName.ToString();
                        @:<br />
                        }

                    }
                </td>                              
            </tr>
            <tr><td colspan="8"><hr /></td></tr>
            <tr><td colspan="8">
                <table style="width:100%" border="0">
                    @{  for (int i = 0; i < Model.listAccountDetail.Count; i+=5)
                        {
                            @:<tr style="height:35px; font-size:12px; color:blue; vertical-align:top">
                            if (i <= Model.listAccountDetail.Count - 1)
                            {
                                @:<td style="width:200px; text-align:left">
                                @:<input type="checkbox" id="chk_@Model.listAccountDetail[i].oAccIndex.ToString()" />
                                @:(
                                @Model.listAccountDetail[i].oAccNo.ToString();
                                @:)
                                @Model.listAccountDetail[i].oAccName.ToString();
                                @:</td>
                            }
                            if (i + 1 <= Model.listAccountDetail.Count - 1)
                            {
                                @:<td style="width:200px; text-align:left">
                                @:<input type="checkbox" id="chk_@Model.listAccountDetail[i + 1].oAccIndex.ToString()" />
                                @:(
                                @Model.listAccountDetail[i + 1].oAccNo.ToString();
                                @:)
                                @Model.listAccountDetail[i + 1].oAccName.ToString();
                                @:</td>
                            }
                            if (i + 2 <= Model.listAccountDetail.Count - 1)
                            {
                                @:<td style="width:200px; text-align:left">
                                @:<input type="checkbox" id="chk_@Model.listAccountDetail[i + 2].oAccIndex.ToString()" />
                                @:(
                                @Model.listAccountDetail[i + 2].oAccNo.ToString();
                                @:)
                                @Model.listAccountDetail[i + 2].oAccName.ToString();
                                @:</td>
                            }
                            if (i + 3 <= Model.listAccountDetail.Count - 1)
                            {
                                @:<td style="width:200px; text-align:left">
                                @:<input type="checkbox" id="chk_@Model.listAccountDetail[i + 3].oAccIndex.ToString()" />
                                @:(
                                @Model.listAccountDetail[i + 3].oAccNo.ToString();
                                @:)
                                @Model.listAccountDetail[i + 3].oAccName.ToString();
                                @:</td>
                            }
                            if (i + 4 <= Model.listAccountDetail.Count - 1)
                            {
                                @:<td style="width:200px; text-align:left">
                                @:<input type="checkbox" id="chk_@Model.listAccountDetail[i + 4].oAccIndex.ToString()" />
                                @:(
                                @Model.listAccountDetail[i + 4].oAccNo.ToString();
                                @:)
                                @Model.listAccountDetail[i + 4].oAccName.ToString();
                                @:</td>
                            }
                            @:</tr>
                        }
                    }

                </table>    
            </td></tr>
            
            <tr><td colspan="8"><hr /></td></tr>
            <tr style="height:35px; font-size:12px; color:blue; vertical-align:top">
                <td style="width:125px; text-align:center"><input type="button" value="一般帳號" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="上級主管" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="二級主管" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="負責窗口" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="代理人" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="專案經理" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="系統分析師" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
                <td style="width:125px; text-align:center"><input type="button" value="開發工程師" style="width:120px; height:30px; font-weight:bold;font-size:14px" /></td>
            </tr>
            <tr><td colspan="8"><span id="showMess"></span></td></tr>            
            <tr><td colspan="8"><br /></td></tr>
        </table>
    </div>
}
