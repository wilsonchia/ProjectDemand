@using MvcDemand.Models
@model AccountRelationModels
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .modal {
        text-align: center;
        position: fixed;
        z-index: 1;
        top: 5%;
        left: 0;
        width: 100%;
        height: 100%;
        font-size: 100%;
        background-color: rgba(0,0,0,0.6) !important;
    }

    .modal_body {
        text-align: center;
        position: absolute;
        background-color: #F6F6F6;
        /*background-color: white;*/
        /*width:90%;*/
        /*width: 870px;*/
        top: 10%;
        left: 0;
        right: 0;
        margin-left: auto;
        margin-right: auto;
        border-style: solid;
        border-color: #2E6E9E;
    }

    .modalU {
        text-align: center;
        position: fixed;
        z-index: 1;
        top: 5%;
        left: 0;
        width: 100%;
        height: 100%;
        font-size: 100%;
        background-color: rgba(0,0,0,0.6) !important;
    }

    .modalU_body {
        text-align: center;
        position: absolute;
        background-color: #F6F6F6;
        /*background-color: white;*/
        /*width:90%;*/
        /*width: 870px;*/
        top: 10%;
        left: 0;
        right: 0;
        margin-left: auto;
        margin-right: auto;
        border-style: solid;
        border-color: #2E6E9E;
    }
</style>
<script type="text/javascript">

    var baseURL = '@Html.Raw(Url.Content("~"))';
    if (baseURL == '/') { baseURL = ""; }

    $(function ($) {
        $('#dropExecute').change(funcSelectChange);
    });

    funcSelectChange = function () {
        var selValue = $('#dropExecute :selected').val();
        $('#showDataCreate').hide(); $('#showDataUpdate').hide(); $('#showUpload').hide();
        switch (selValue) {
            case "":
                $('#showDataUpdate').fadeOut("slow");
                break;
            case "N":
                $('#showDataCreate').fadeIn("slow");
                $("#textAccDateS").datepicker({ dateFormat: 'yy/mm/dd' });
                break;
            case "U":
                $('#showUpload').fadeIn("slow");
                break;
            case "O":
                $('#showDataUpdate').fadeOut("slow");
                FormExcelOut();
                break;
        }
        return false;
    }

</script>
    @using (Html.BeginForm("Index", "AccountRelation", FormMethod.Post, new { id = "form1" }))
{
    <div id="showList">
            <table style="width:100%" border="0" cellpadding="0" cellspacing="0">
                <tr style="height:40px; font-size:20px; font-weight:bold"><td style="width:100%; text-align:center" colspan="2">使用帳號關聯資料檔<hr /></td></tr>
                <tr style="height:35px;">
                    <td style="width:700px; text-align:left">
        關鍵字 : @Html.TextBox("searchValue", (string)ViewBag.searchValue, new { Style = "width:600px; height:35px" })
                    <input type="submit" id="btnsubmit" value="查詢" style="width:100px; height:30px;font-weight:bold;font-size:18px" />
                </td>
                <td style="width:200px; text-align:right">
                    <select id="dropExecute" name="dropExecute" style="width:200px; height:30px;font-size:16px;font-weight:bold">
                        <option value="">請選擇</option>
                        <option value="N">新增帳號關聯</option>
                        <option value="U">匯入關聯資料</option>
                        <option value="O">匯出關聯資料</option>
                    </select>
                </td>
            </tr>
            <tr id="showUpload" style="vertical-align:middle;display:none">
                <td style="width:700px; text-align:left">
                    <input type="file" id="fileUpload" name="fileUpload" style="width:100%; height:30px;" />
                </td>
                <td style="width:200px; text-align:right">
                    <input type="button" id="btnUpload" value="上傳" style="width:100px; height:30px; font-size:16px; font-weight:bold" onclick="FormExcelUpload();" />
                </td>
            </tr>
            <tr><td style="width:100%" colspan="4"><hr /></td></tr>
        </table>
    </div>
    @Html.Hidden("hideAccIndex")
    @Html.Hidden("hideRelationClass")
    @Html.Hidden("hideRelationAccIndex")
    <div id="showDataCreate" class="modal" style="display:none;text-align:center">
        <table class="modal_body" style="width:700px;" border="0" cellpadding="0" cellspacing="0">
            <tr style="height:40px; font-size:20px; font-weight:bold"><td style="width:100%; text-align:center" colspan="4">新增使用帳號關聯資料</td></tr>
            <tr style="height:30px">
                <td style="width:100px; text-align:center; background-color:#5F9EA0; color:white;font-weight:bold">員工帳號</td>
                <td style="width:250px; text-align:left">@Html.TextBox("textSystemClass", "", new { Style = "width:90%; height:30px" })</td>
                <td style="width:100px; text-align:center; background-color:#5F9EA0; color:white;font-weight:bold">主管類別</td>
                <td style="width:250px; text-align:left">@Html.TextBox("textSystemValue", "", new { Style = "width:90%; height:30px" })</td>
            </tr>
            <tr style="height:30px">
                <td style="width:100px; text-align:center; background-color:#5F9EA0; color:white;font-weight:bold">關聯清單</td>
                <td style="width:900px; text-align:left" colspan="3">


                </td>
            </tr>
            <tr><td colspan="4"><span id="showMess"></span></td></tr>
            <tr style="height:30px">
                <td style="width:100%; text-align:center" colspan="4">
                    <input type="button" id="btnFormC" value="確認新增" style="width:200px; height:30px;font-weight:bold; font-size:18px" onclick="return FormDataCreate();" />
                    <input type="button" id="btnCleanC" value="取消新增" style="width:200px; height:30px; font-weight:bold; font-size:18px" onclick="$('#showDataCreate').hide();" />
                </td>
            </tr>
            <tr><td colspan="4"><br /></td></tr>
        </table>
    </div>
}
